---
- hosts: all
  any_errors_fatal: true
  roles:
    - ansible-grafana
  vars:
    grafana_version: 6.2.5
    grafana_yum_repo_template: alternative.grafana.yum.repo.j2
    grafana_security:
      admin_user: admin
      admin_password: "password"
    grafana_address: "127.0.0.1"
    grafana_auth:
      login_maximum_inactive_lifetime_days: 42
      disable_login_form: false
      oauth_auto_login: false
      disable_signout_menu: false
      signout_redirect_url: ""
      anonymous:
        org_name: "Main Organization"
        org_role: Viewer
      ldap:
        config_file: "/etc/grafana/ldap.toml"
        allow_sign_up: false
      basic:
        enabled: true
    grafana_ldap:
      verbose_logging: false
      servers:
        host: 127.0.0.1
        port: 389
        use_ssl: false
        start_tls: false
        ssl_skip_verify: false
        root_ca_cert: /path/to/certificate.crt
        bind_dn: "cn=admin,dc=grafana,dc=org"
        bind_password: grafana
        search_filter: "(cn=%s)"
        search_base_dns:
          - "dc=grafana,dc=org"
        group_search_filter: "(&(objectClass=posixGroup)(memberUid=%s))"
        group_search_base_dns:
          - "ou=groups,dc=grafana,dc=org"
        attributes:
          name: givenName
          surname: sn
          username: sAMAccountName
          member_of: memberOf
          email: mail
      group_mappings:
        - name: Main Organization
          id: 1
          groups:
            - group_dn: "cn=admins,ou=groups,dc=grafana,dc=org"
              org_role: Admin
            - group_dn: "cn=editors,ou=groups,dc=grafana,dc=org"
              org_role: Editor
            - group_dn: "*"
              org_role: Viewer
        - name: Alternative Org
          id: 2
          groups:
            - group_dn: "cn=alternative_admins,ou=groups,dc=grafana,dc=org"
              org_role: Admin
    grafana_api_keys:
      - name: "admin"
        role: "Admin"
      - name: "viewer"
        role: "Viewer"
      - name: "editor"
        role: "Editor"
    grafana_api_keys_dir: "/tmp/grafana/keys"
    grafana_plugins:
      - raintank-worldping-app
    grafana_alert_notifications:
      notifiers:
        - name: "Email Alert"
          type: "email"
          uid: notifier1
          is_default: true
          settings:
            addresses: "example@example.com"
    grafana_dashboards:
      - dashboard_id: '1860'
        revision_id: '4'
        datasource: 'Prometheus'
      - dashboard_id: '358'
        revision_id: '1'
        datasource: 'Prometheus'
    grafana_datasources:
      - name: "Prometheus"
        type: "prometheus"
        access: "proxy"
        url: "http://prometheus.mydomain"
        basicAuth: true
        basicAuthUser: "admin"
        basicAuthPassword: "password"
        isDefault: true
        jsonData:
          tlsAuth: false
          tlsAuthWithCACert: false
          tlsSkipVerify: true
    grafana_log:
      mode: syslog
      level: warn
